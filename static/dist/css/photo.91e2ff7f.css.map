{"version":3,"file":"static/dist/css/photo.91e2ff7f.css","mappings":"AA4FA,oCACE,iBAAkB,CAClB,UAAW,CACX,+BAAiC,CACjC,cACF,CAEA,0CACE,UAAW,CACX,iBAAkB,CAClB,KAAM,CACN,MAAO,CACP,UAAW,CACX,WAAY,CACZ,iBAAkB,CAClB,6CACF,CAEA,0CACE,oBAAqB,CACrB,UAAW,CACX,mCACF,CAEA,kCACE,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,gBAAkB,CAClB,eAAgB,CAChB,UAAW,CACX,cACF,CACA,2DACE,UAAW,CACX,oBACF,CACA,2BACE,YACF","sources":["webpack://front/./src/pages/photo/index.vue"],"sourcesContent":["<template>\r\n  <section>\r\n    <h3>写真</h3>\r\n    <p class=\"py-2\">\r\n      アンプラのイベントの写真を公開しています。<br>\r\n      LiveLogに登録されていないBBQやお花見のイベントの写真もあります！\r\n    </p>\r\n    <div class=\"row\" v-if=\"photoStaff\" v-cloak>\r\n      <a href=\"/admin/pictures/album/\">アルバムの登録・編集はこちらから</a>\r\n    </div>\r\n    <div v-for=\"y in yearsSet\" :key=\"y\" class=\"row\">\r\n      <h4 class=\"col-12\">{{y}}年度</h4>\r\n      <div v-for=\"item in getItems(y)\" :key=\"item.id\" class=\"cardwrap col-6 col-xs-6 col-sm-6 col-md-4 col-lg-3 my-2\">\r\n        <article class=\"card\">\r\n          <img class=\"card-img-top\" :src=\"thumbnailPath(item)\" />\r\n          <a :href=\"item.url\" class=\"card-img-overlay\" target=\"_blank\">\r\n            <h5 class=\"card-title\" v-text=\"item.title\"></h5>\r\n            <span>{{ displayDate(item.date) }}</span>\r\n          </a>\r\n        </article>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"../../utils/moment\";\r\nimport { computed, reactive } from \"vue\";\r\nimport axios from \"../../utils/axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const photos = reactive([]);\r\n\r\n    axios.get(\"/api/photo/\").then(res => {\r\n      photos.length = 0;\r\n      photos.push(...res.data.photos);\r\n    }).catch(error => {\r\n      console.error(error.response);\r\n      store.commit(\"message/addMessage\", {\r\n        level: \"warning\",\r\n        message: \"アルバムを取得できませんでした。\",\r\n        appname: \"photos/index\"\r\n      });\r\n    });\r\n\r\n    const years = computed(() => photos.map(item => {\r\n      const date = moment(item.date);\r\n      let year = 0;\r\n      if (date.isBefore(moment().set({year:date.year(), month:3, day:1}))) {\r\n        year = date.year() - 1;//                       month:3 => 4月\r\n      } else {\r\n        year = date.year();\r\n      }\r\n      return year;\r\n    }));\r\n    const yearsSet = computed(() => years.value.filter(\r\n      (x, i, self) => self.indexOf(x) === i\r\n    ).reverse());\r\n    // 重複しない年度の数字を取得\r\n\r\n    const getItems = year => {\r\n      return photos.filter(item => moment(item.date).isBetween(\r\n        moment(`${year}-04-01`),\r\n        moment(`${year+1}-04-01`),\r\n        undefined, \"[)\")\r\n      ).reverse();\r\n    };\r\n\r\n    \r\n\r\n    const displayDate = dateStr => moment(dateStr).format(\"YYYY/MM/DD\");\r\n    const thumbnailPath = item => {\r\n      if (item.thumbnail) {\r\n        return item.thumbnail;\r\n      } else {\r\n        return \"/static/img/album_thum_default.jpg\";\r\n      }\r\n    };\r\n\r\n    const photoStaff = computed(() => store.state.user.is_staff);\r\n\r\n    return {\r\n      photos, years, yearsSet, photoStaff,\r\n      getItems, displayDate, thumbnailPath\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\na.card-img-overlay{\r\n  border-radius: 3px;\r\n  color: #fff;\r\n  background-color: rgba(0,0,0,0.3);\r\n  transition: 0.4s;\r\n}\r\n\r\na.card-img-overlay:after{\r\n  content: \"\";\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 3px;\r\n  box-shadow: inset 0 0 0px 5px rgba(255,255,255,0.5);\r\n}\r\n\r\na.card-img-overlay.hover{\r\n  text-decoration: none;\r\n  color: #000;\r\n  background-color: rgba(255,255,255,0.5);\r\n}\r\n\r\nh6.card-subtitle{\r\n  position: absolute;\r\n  right: 1rem;\r\n  bottom: 1rem;\r\n  font-size: 0.75rem;\r\n  font-weight: 400;\r\n  color: #fff;\r\n  transition: 0.4s;\r\n}\r\na.card-img-overlay.hover h6.card-subtitle{\r\n  color: #000;\r\n  text-decoration: none;\r\n}\r\n[v-cloak] {\r\n  display: none;\r\n}\r\n</style>"],"names":[],"sourceRoot":""}