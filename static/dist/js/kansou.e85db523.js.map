{"version":3,"file":"static/dist/js/kansou.e85db523.js","mappings":"oPAEIA,EAAAA,EAAAA,GAAa,UAAT,QAAI,K,GAEFC,MAAM,qB,GACNA,MAAM,kB,oCAaJD,EAAAA,EAAAA,GAAM,qB,GACAC,MAAM,S,0CAlBtBC,EAAAA,EAAAA,IAyBU,gBAxBRC,IAwBQ,aAvBRD,EAAAA,EAAAA,IAsBUE,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAtBcC,EAAAA,UAARC,K,WAAhBL,EAAAA,EAAAA,IAsBU,WAtByBM,IAAKD,EAAMN,MAAM,yBAApD,EACED,EAAAA,EAAAA,GAA+C,KAA/C,GAA+CS,EAAAA,EAAAA,IAAdF,GAAO,KAAE,IAC1CP,EAAAA,EAAAA,GAmBK,KAnBL,EAmBK,gBAlBHE,EAAAA,EAAAA,IAiBKE,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAhBYC,EAAAA,SAASC,IAAjBG,K,WADTR,EAAAA,EAAAA,IAiBK,MAfFM,IAAKE,EAAKC,GACXV,MAAM,8BAHR,EAKED,EAAAA,EAAAA,GAEI,KAFAY,KAAI,oBAAsBF,EAAKC,MAAOE,OAAO,WAAjD,QACKH,EAAKI,OAAQ,OAAGL,EAAAA,EAAAA,IAAGC,EAAKK,MAAO,MACpC,EAAAC,IACAhB,EAAAA,EAAAA,GAEO,QAFAiB,SAAUP,EAAKQ,YAAajB,MAAM,UAAzC,QACKK,EAAAA,YAAYI,EAAKQ,cAAW,EAAAC,GAEjBT,EAAKU,SAAAA,EAAAA,EAAAA,OAArBlB,EAAAA,EAAAA,IAKWE,EAAAA,GAAA,CAAAI,IAAAA,GAAA,CAJTa,GACArB,EAAAA,EAAAA,GAEO,OAFP,GAEOS,EAAAA,EAAAA,IADFC,EAAKU,QAAM,IAHlB,0BAXF,aAHJ,O,6CA+BJ,GACEE,QACE,MAAMC,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,IAAS,IAExBC,EAAAA,EAAAA,IACO,gBACJC,MAAMC,IACLJ,EAAOK,OAAS,EAChBL,EAAOM,QAAQF,EAAIG,KAAKP,OAAxB,IAEDQ,OAAOC,IACNC,QAAQD,MAAMA,EAAME,UACpBb,EAAMc,OAAO,qBAAsB,CACjCC,MAAO,UACPC,QAAS,uBACTC,QAAS,gBAHX,IAOJ,MAAMC,GAAQC,EAAAA,EAAAA,KAAS,IACrBjB,EAAOkB,KAAKjC,IACV,MAAMkC,GAAOC,EAAAA,EAAAA,GAAOnC,EAAKQ,aACzB,IAAIX,EAAO,EAQX,OAJEA,EAFAqC,EAAKE,UAASD,EAAAA,EAAAA,KAASE,IAAI,CAAExC,KAAMqC,EAAKrC,OAAQyC,MAAO,EAAGC,IAAK,KAExDL,EAAKrC,OAAS,EAEdqC,EAAKrC,OAEPA,CAAP,MAGE2C,GAAWR,EAAAA,EAAAA,KAAS,IACxBD,EAAMU,MAAMC,QAAO,CAACC,EAAGC,EAAGC,IAASA,EAAKC,QAAQH,KAAOC,IAAGG,YAItDC,EAAYnD,GACTkB,EACJ2B,QAAQ1C,IACPmC,EAAAA,EAAAA,GAAOnC,EAAKQ,aAAayC,WACvBd,EAAAA,EAAAA,GAAQ,GAAEtC,YACVsC,EAAAA,EAAAA,GAAQ,GAAEtC,EAAO,gBACjBqD,EACA,QAGHH,UAGCI,EAAeC,IAAYjB,EAAAA,EAAAA,GAAOiB,GAASC,OAAO,cAClDC,GAActB,EAAAA,EAAAA,KAAS,IAAMnB,EAAM0C,MAAMC,KAAKC,WAEpD,MAAO,CACLjB,WACAc,cACAvC,SACAgB,QACAiB,WACAG,cAEH,G,UC1FH,MAAMO,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://front/./src/pages/kansou/index.vue","webpack://front/./src/pages/kansou/index.vue?cdbe"],"sourcesContent":["<template>\r\n  <article>\r\n    <h3>感想用紙</h3>\r\n    <section v-for=\"year in yearsSet\" :key=\"year\" class=\"pure-menu-custom card\">\r\n      <h4 class=\"pure-menu-heading\">{{ year }}年度</h4>\r\n      <ul class=\"pure-menu-list\">\r\n        <li\r\n          v-for=\"item in getItems(year)\"\r\n          :key=\"item.id\"\r\n          class=\"pure-menu-item kansou-item\"\r\n        >\r\n          <a :href=\"`/download/kansou/${item.id}/`\" target=\"_blank\">\r\n            {{ item.title }} ( {{ item.size }} )\r\n          </a>\r\n          <time :datetime=\"item.performedAt\" class=\"small\">\r\n            {{ displayDate(item.performedAt) }}\r\n          </time>\r\n          <template v-if=\"item.detail\">\r\n            <br />\r\n            <span class=\"small\">\r\n              {{ item.detail }}\r\n            </span>\r\n          </template>\r\n        </li>\r\n      </ul>\r\n    </section>\r\n  </article>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"../../utils/moment\";\r\nimport { computed, reactive } from \"vue\";\r\nimport axios from \"../../utils/axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const kansou = reactive([]);\r\n\r\n    axios\r\n      .get(\"/api/kansou/\")\r\n      .then((res) => {\r\n        kansou.length = 0;\r\n        kansou.push(...res.data.kansou);\r\n      })\r\n      .catch((error) => {\r\n        console.error(error.response);\r\n        store.commit(\"message/addMessage\", {\r\n          level: \"warning\",\r\n          message: \"感想用紙のデータを取得できませんでした。\",\r\n          appname: \"kansou/index\",\r\n        });\r\n      });\r\n\r\n    const years = computed(() =>\r\n      kansou.map((item) => {\r\n        const date = moment(item.performedAt);\r\n        let year = 0;\r\n        if (\r\n          date.isBefore(moment().set({ year: date.year(), month: 3, day: 1 }))\r\n        ) {\r\n          year = date.year() - 1; //                       month:3 => 4月\r\n        } else {\r\n          year = date.year();\r\n        }\r\n        return year;\r\n      })\r\n    );\r\n    const yearsSet = computed(() =>\r\n      years.value.filter((x, i, self) => self.indexOf(x) === i).reverse()\r\n    );\r\n    // 重複しない年度の数字を取得\r\n\r\n    const getItems = (year) => {\r\n      return kansou\r\n        .filter((item) =>\r\n          moment(item.performedAt).isBetween(\r\n            moment(`${year}-04-01`),\r\n            moment(`${year + 1}-04-01`),\r\n            undefined,\r\n            \"[)\"\r\n          )\r\n        )\r\n        .reverse();\r\n    };\r\n\r\n    const displayDate = (dateStr) => moment(dateStr).format(\"YYYY/MM/DD\");\r\n    const kansouStaff = computed(() => store.state.user.is_staff);\r\n\r\n    return {\r\n      yearsSet,\r\n      kansouStaff,\r\n      kansou,\r\n      years,\r\n      getItems,\r\n      displayDate,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card {\r\n  margin-bottom: 0.5rem;\r\n}\r\n.kansou-item {\r\n  padding: 0.5em 1em;\r\n  line-height: 1.5;\r\n  time {\r\n    padding: 0 0.5rem;\r\n  }\r\n}\r\n</style>","import { render } from \"./index.vue?vue&type=template&id=244f9831&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=244f9831&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\mhash\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-244f9831\"]])\n\nexport default __exports__"],"names":["_createElementVNode","class","_createElementBlock","_hoisted_1","_Fragment","_renderList","$setup","year","key","_toDisplayString","item","id","href","target","title","size","_hoisted_4","datetime","performedAt","_hoisted_5","detail","_hoisted_6","setup","store","useStore","kansou","reactive","axios","then","res","length","push","data","catch","error","console","response","commit","level","message","appname","years","computed","map","date","moment","isBefore","set","month","day","yearsSet","value","filter","x","i","self","indexOf","reverse","getItems","isBetween","undefined","displayDate","dateStr","format","kansouStaff","state","user","is_staff","__exports__","render"],"sourceRoot":""}