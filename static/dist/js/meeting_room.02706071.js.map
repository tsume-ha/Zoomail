{"version":3,"file":"static/dist/js/meeting_room.02706071.js","mappings":"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","sources":["webpack://front/./src/pages/meeting_room/formatter.js","webpack://front/./src/pages/meeting_room/index.vue","webpack://front/./src/pages/meeting_room/index.vue?1303","webpack://front/./src/pages/meeting_room/register.vue","webpack://front/./src/pages/meeting_room/register.vue?30f1"],"sourcesContent":["import moment from \"@/utils/moment.js\";\r\n\r\nexport const md = (date) => moment(date).format(\"M/DD (dd)\");\r\n\r\nexport const dayColor = (date) => {\r\n  const day = moment(date).format(\"d\");\r\n  if (day === \"0\") {\r\n    return \"text-danger\";\r\n  } else if (day === \"6\") {\r\n    return \"text-primary\";\r\n  } else {\r\n    return \"\";\r\n  }\r\n};\r\n\r\nexport const room = (room) => {\r\n  if (room === null) {\r\n    return \"例会教室は未登録\";\r\n  } else {\r\n    return room;\r\n  }\r\n};\r\n\r\nexport const roomColor = (room) => {\r\n  switch (room) {\r\n    case \"終日使用不可\":\r\n    case \"使用不可\":\r\n      return \"text-danger\";\r\n    case null:\r\n      return \"text-muted\";\r\n    case \"(20時まで音出し不可)\":\r\n      return \"text-success\";\r\n    default:\r\n      return \"\";\r\n  }\r\n};","<template>\r\n  <article>\r\n    <h3>例会教室</h3>\r\n    <div id=\"today-room\" class=\"card\">\r\n      今日(\r\n      <span :class=\"dayColor(todayRoom.date)\">\r\n        {{ md(todayRoom.date) }}\r\n      </span>\r\n      )の例会教室は、<br />\r\n      <span id=\"today-room-name\">\r\n        「\r\n        <span :class=\"roomColor(todayRoom.room)\">\r\n          {{ room(todayRoom.room) }}\r\n        </span>\r\n        」\r\n      </span>\r\n      です。\r\n    </div>\r\n    <div id=\"register\" class=\"card\" v-if=\"registerPermission\">\r\n      <h4>教室係用メニュー</h4>\r\n      <router-link\r\n        :to=\"{ name: 'meeting_room:register' }\"\r\n        class=\"button button-primary\"\r\n        >例会教室データの修正・登録 <Icon :icon=\"['fas', 'edit']\"\r\n      /></router-link>\r\n    </div>\r\n    <div id=\"ical\" class=\"card\">\r\n      <h4>Googleカレンダー連携</h4>\r\n      <p>\r\n        Googleカレンダーなどに例会教室データを表示できるようにしました。<br />くわしくは下のリンクから\r\n      </p>\r\n      <a\r\n        href=\"/howto/meeting_room/\"\r\n        class=\"button button-primary\"\r\n        target=\"_blank\"\r\n        >Googleカレンダー連携の方法 <Icon :icon=\"['far', 'calendar-plus']\"\r\n      /></a>\r\n    </div>\r\n    <div id=\"rooms\" class=\"card\">\r\n      <h4>1カ月先までの例会教室一覧</h4>\r\n      <p v-if=\"rooms.length === 0\">Now Loading...</p>\r\n      <table v-else class=\"pure-table pure-table-bordered\">\r\n        <tr v-for=\"data in rooms\" :key=\"data.date\">\r\n          <td>\r\n            <span :class=\"dayColor(data.date)\">\r\n              {{ md(data.date) }}\r\n            </span>\r\n          </td>\r\n          <td>\r\n            <span :class=\"roomColor(data.room)\">\r\n              {{ room(data.room) }}\r\n            </span>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n  </article>\r\n</template>\r\n\r\n<script setup>\r\nimport moment from \"@/utils/moment.js\";\r\nimport axios from \"@/utils/axios.js\";\r\nimport { computed, ref } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport { md, dayColor, room, roomColor } from \"./formatter\";\r\nconst store = useStore();\r\nconst registerPermission = computed(\r\n  () => store.state.mypage.userInfo.canRegisterMeetingRoom\r\n);\r\n\r\nconst rooms = ref([]);\r\n\r\naxios.get(\"/api/meeting_room/get31day/\").then((res) => {\r\n  rooms.value = res.data.rooms;\r\n});\r\n\r\nconst todayRoom = computed(() => {\r\n  const date = moment().format(\"YYYY-MM-DD\");\r\n  const result = rooms.value.find((obj) => obj.date === date);\r\n  if (result === undefined) {\r\n    return {\r\n      date,\r\n      room: null,\r\n    };\r\n  } else {\r\n    return result;\r\n  }\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card {\r\n  padding: 1rem;\r\n  margin-bottom: 1rem;\r\n  width: 100%;\r\n}\r\n#today-room {\r\n  margin: 1rem auto;\r\n  #today-room-name {\r\n    font-size: 1.2rem;\r\n    line-height: 1.5;\r\n  }\r\n}\r\nh4 {\r\n  display: block;\r\n  margin: 0 0 1rem;\r\n}\r\n#register .button {\r\n  display: inline-block;\r\n  margin: 0;\r\n  padding: 0.75rem;\r\n}\r\n#ical .button {\r\n  display: inline-block;\r\n  margin: 0.5rem 0;\r\n  padding: 0.75rem;\r\n}\r\n.text-danger {\r\n  color: $text-red;\r\n}\r\n.text-primary {\r\n  color: $text-blue;\r\n}\r\n.text-success {\r\n  color: $text-green;\r\n}\r\n.text-muted {\r\n  color: $text-dark;\r\n}\r\n</style>","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=0d609b74&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\mhash\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0d609b74\"]])\n\nexport default __exports__","<template>\r\n  <article>\r\n    <h3>例会教室登録・修正</h3>\r\n    <div class=\"card\">\r\n      <form autocomplete=\"off\" class=\"pure-menu pure-form\">\r\n        <h4 class=\"pure-menu-heading\">{{ year }}年{{ month }}月</h4>\r\n        <ul class=\"pure-menu-list\">\r\n          <li v-for=\"room in rooms\" :key=\"room.date\" class=\"pure-menu-item\">\r\n            <div class=\"date\">\r\n              <span :class=\"dayColor(room.date)\">{{ md(room.date) }}</span>\r\n            </div>\r\n            <div class=\"room\">\r\n              <input\r\n                type=\"text\"\r\n                v-model=\"room.room\"\r\n                @change=\"onChangeHandler(room.date)\"\r\n                placeholder=\"未登録\"\r\n                list=\"rooms-presets\"\r\n              />\r\n            </div>\r\n          </li>\r\n          <datalist id=\"rooms-presets\">\r\n            <option value=\"学生集会所 3階共用室\"></option>\r\n            <option value=\"学生集会所 2階共用室\"></option>\r\n            <option value=\"4共21\"></option>\r\n            <option value=\"4共22\"></option>\r\n            <option value=\"4共24\"></option>\r\n            <option value=\"4共30\"></option>\r\n            <option value=\"4共31\"></option>\r\n          </datalist>\r\n        </ul>\r\n      </form>\r\n      <div class=\"pure-control-group custom-two-buttons-wrapper\">\r\n        <button @click=\"move(-1)\" class=\"pure-button button-primary\">\r\n          前の月\r\n        </button>\r\n        <button @click=\"move(1)\" class=\"pure-button button-primary\">\r\n          次の月\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <router-link :to=\"{ name: 'meeting_room:index' }\" class=\"pure-button return\"\r\n      >戻る</router-link\r\n    >\r\n    <div v-if=\"APIQueue > 0\" id=\"api-saving-text\">saving...</div>\r\n  </article>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, ref } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { useStore } from \"vuex\";\r\nimport axios from \"@/utils/axios.js\";\r\nimport moment from \"@/utils/moment\";\r\nimport { md, dayColor } from \"./formatter\";\r\nconst store = useStore();\r\nconst router = useRouter();\r\n\r\nconst permission = computed(\r\n  () => store.state.mypage.userInfo.canRegisterMeetingRoom\r\n);\r\nif (!permission.value) {\r\n  store.commit(\"message/addMessage\", {\r\n    level: \"warning\",\r\n    message: \"教室係の権限が無いようです\",\r\n    appname: \"meeting_room/register\",\r\n  });\r\n  router.push({ name: \"meeting_room:index\" });\r\n}\r\n\r\nconst today = moment();\r\nconst year = ref(today.year());\r\nconst month = ref(today.month() + 1);\r\n\r\nconst rooms = ref([]);\r\nconst loading = ref(false);\r\nconst getRoomsFromAPI = async (year, month) => {\r\n  loading.value = true;\r\n  const response = await axios.get(\"/api/meeting_room/get_by_month/\", {\r\n    params: {\r\n      year,\r\n      month,\r\n    },\r\n  });\r\n  rooms.value = response.data.rooms;\r\n  loading.value = false;\r\n};\r\n\r\ngetRoomsFromAPI(year.value, month.value);\r\n\r\nconst APIQueue = ref(0);\r\nconst onChangeHandler = async (date) => {\r\n  // 対象を日付から取得\r\n  const target = rooms.value.find((obj) => obj.date === date);\r\n  // 送信データを作成\r\n  const data = new FormData();\r\n  data.set(\"date\", target.date);\r\n  data.set(\"room_name\", target.room || \"\");\r\n  // 送信\r\n  APIQueue.value++;\r\n  const response = await axios.post(\"/api/meeting_room/register/\", data);\r\n  APIQueue.value--;\r\n  // 帰ってきたデータを確認\r\n  if (\r\n    !(\r\n      response.data.room === target.room && response.data.date === target.date\r\n    ) &&\r\n    !(target.room === \"\" && response.data.room === null)\r\n  ) {\r\n    // どっちかが異なる場合\r\n    // 帰ってきたデータで上書きしておく\r\n    rooms.value = [\r\n      ...[...rooms.value].map((obj) =>\r\n        obj.date === target.date ? { ...response.data } : obj\r\n      ),\r\n    ];\r\n    // 警告をだしておく\r\n    store.commit(\"message/addMessage\", {\r\n      level: \"warning\",\r\n      message: `${target.date}のデータが更新に失敗しました`,\r\n      appname: \"meeting_room/register\",\r\n    });\r\n  }\r\n};\r\n\r\nconst move = async (num) => {\r\n  const currentDate = moment([year.value, month.value - 1]);\r\n  currentDate.add(num, \"months\");\r\n  year.value = currentDate.year();\r\n  month.value = currentDate.month() + 1;\r\n  rooms.value.length = 0;\r\n  await getRoomsFromAPI(year.value, month.value);\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.card {\r\n  padding: 0.5rem;\r\n  margin-bottom: 2rem;\r\n\r\n  h4 {\r\n    padding: 0.5rem 0 0.75rem;\r\n  }\r\n\r\n  ul li div {\r\n    display: inline-block;\r\n\r\n    &.date {\r\n      width: 6rem;\r\n    }\r\n    &.room {\r\n      width: calc(100% - 6rem);\r\n      min-width: 10rem;\r\n      input {\r\n        width: 100%;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\ninput::placeholder {\r\n  color: $text-dark;\r\n}\r\n.text-danger {\r\n  color: $text-red;\r\n}\r\n.text-primary {\r\n  color: $text-blue;\r\n}\r\n.text-success {\r\n  color: $text-green;\r\n}\r\n.text-muted {\r\n  color: $text-dark;\r\n}\r\n#api-saving-text {\r\n  display: block;\r\n  position: fixed;\r\n  bottom: 1rem;\r\n  left: 1rem;\r\n}\r\n</style>","import script from \"./register.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./register.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./register.vue?vue&type=style&index=0&id=0fe12a3d&scoped=true&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\mhash\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0fe12a3d\"]])\n\nexport default __exports__"],"names":["md","date","moment","format","dayColor","day","room","roomColor","store","useStore","registerPermission","computed","state","mypage","userInfo","canRegisterMeetingRoom","rooms","ref","axios","then","res","value","data","todayRoom","result","find","obj","undefined","__exports__","router","useRouter","permission","commit","level","message","appname","push","name","today","year","month","loading","getRoomsFromAPI","async","response","params","APIQueue","onChangeHandler","target","FormData","set","map","move","currentDate","add","num","length"],"sourceRoot":""}