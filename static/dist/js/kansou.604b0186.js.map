{"version":3,"file":"static/dist/js/kansou.604b0186.js","mappings":"oPAEI,OAAa,UAAT,QAAI,K,GAEFA,MAAM,qB,GACNA,MAAM,kB,oCAYJ,OAAI,qB,GACEA,MAAM,S,0CAjBtB,QAwBU,gBAvBR,IAuBQ,aAtBR,QAqBU,mBArBc,EAAAC,UAARC,K,WAAhB,QAqBU,WArByBC,IAAKD,EAAMF,MAAM,yBAApD,EACE,OAA6C,KAA7C,GAA6C,QAAbE,GAAM,KAAE,IACxC,OAkBK,KAlBL,EAkBK,gBAjBH,QAgBK,mBAfY,EAAAE,SAASF,IAAjBG,K,WADT,QAgBK,MAf6BF,IAAKE,EAAKC,GAC1CN,MAAM,8BAFR,EAIE,OAEI,KAFAO,KAAI,oBAAsBF,EAAKC,MAAOE,OAAO,WAAjD,QACKH,EAAKI,OAAQ,OAAG,QAAGJ,EAAKK,MAAO,MACpC,MACA,OAEO,QAFAC,SAAUN,EAAKO,YAAaZ,MAAM,UAAzC,QACK,EAAAa,YAAYR,EAAKO,cAAW,KAEjBP,EAAKS,SAAA,WAArB,QAKW,cAJT,GACA,OAEO,OAFP,GAEO,QADFT,EAAKS,QAAM,IAHlB,0BAVF,aAHJ,Q,4CA8BJ,GACEC,QACE,MAAMC,GAAQ,UACRC,GAAS,QAAS,IAExBC,EAAA,MAAU,gBAAgBC,MAAKC,IAC7BH,EAAOI,OAAS,EAChBJ,EAAOK,QAAQF,EAAIG,KAAKN,WACvBO,OAAMC,IACPC,QAAQD,MAAMA,EAAME,UACpBX,EAAMY,OAAO,qBAAsB,CACjCC,MAAO,UACPC,QAAS,uBACTC,QAAS,oBAIb,MAAMC,GAAQ,SAAS,IAAMf,EAAOgB,KAAI5B,IACtC,MAAM6B,GAAO,EAAAC,EAAA,GAAO9B,EAAKO,aACzB,IAAIV,EAAO,EAMX,OAJEA,EADEgC,EAAKE,UAAS,EAAAD,EAAA,KAASE,IAAI,CAACnC,KAAKgC,EAAKhC,OAAQoC,MAAM,EAAGC,IAAI,KACtDL,EAAKhC,OAAS,EAEdgC,EAAKhC,OAEPA,OAEHD,GAAW,SAAS,IAAM+B,EAAMQ,MAAMC,QAC1C,CAACC,EAAGC,EAAGC,IAASA,EAAKC,QAAQH,KAAOC,IACpCG,YAGI1C,EAAWF,GACRe,EAAOwB,QAAOpC,IAAQ,EAAA8B,EAAA,GAAO9B,EAAKO,aAAamC,WACpD,EAAAZ,EAAA,GAAQ,GAAEjC,YACV,EAAAiC,EAAA,GAAQ,GAAEjC,EAAK,gBACf8C,EAAW,QACXF,UAKEjC,EAAcoC,IAAW,EAAAd,EAAA,GAAOc,GAASC,OAAO,cAChDC,GAAc,SAAS,IAAMnC,EAAMoC,MAAMC,KAAKC,WAEpD,MAAO,CACLrD,SAAAA,EAAUkD,YAAAA,EAAalC,OAAAA,EAAQe,MAAAA,EAC/B5B,SAAAA,EAAUS,YAAAA,K,UCzEhB,MAAM0C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF","sources":["webpack://front/./src/pages/kansou/index.vue","webpack://front/./src/pages/kansou/index.vue?01cc"],"sourcesContent":["<template>\r\n  <article>\r\n    <h3>感想用紙</h3>\r\n    <section v-for=\"year in yearsSet\" :key=\"year\" class=\"pure-menu-custom card\">\r\n      <h4 class=\"pure-menu-heading\">{{year}}年度</h4>\r\n      <ul class=\"pure-menu-list\">\r\n        <li\r\n          v-for=\"item in getItems(year)\" :key=\"item.id\"\r\n          class=\"pure-menu-item kansou-item\"\r\n        >\r\n          <a :href=\"`/download/kansou/${item.id}/`\" target=\"_blank\">\r\n            {{ item.title }} ( {{ item.size }} )\r\n          </a>\r\n          <time :datetime=\"item.performedAt\" class=\"small\">\r\n            {{ displayDate(item.performedAt) }}\r\n          </time>\r\n          <template v-if=\"item.detail\">\r\n            <br>\r\n            <span class=\"small\">\r\n              {{ item.detail }}\r\n            </span>\r\n          </template>\r\n        </li>\r\n      </ul>\r\n    </section>\r\n  </article>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"../../utils/moment\";\r\nimport { computed, reactive } from \"vue\";\r\nimport axios from \"../../utils/axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const kansou = reactive([]);\r\n\r\n    axios.get(\"/api/kansou/\").then(res => {\r\n      kansou.length = 0;\r\n      kansou.push(...res.data.kansou);\r\n    }).catch(error => {\r\n      console.error(error.response);\r\n      store.commit(\"message/addMessage\", {\r\n        level: \"warning\",\r\n        message: \"感想用紙のデータを取得できませんでした。\",\r\n        appname: \"kansou/index\"\r\n      });\r\n    });\r\n\r\n    const years = computed(() => kansou.map(item => {\r\n      const date = moment(item.performedAt);\r\n      let year = 0;\r\n      if (date.isBefore(moment().set({year:date.year(), month:3, day:1}))) {\r\n        year = date.year() - 1;//                       month:3 => 4月\r\n      } else {\r\n        year = date.year();\r\n      }\r\n      return year;\r\n    }));\r\n    const yearsSet = computed(() => years.value.filter(\r\n      (x, i, self) => self.indexOf(x) === i\r\n    ).reverse());\r\n    // 重複しない年度の数字を取得\r\n\r\n    const getItems = year => {\r\n      return kansou.filter(item => moment(item.performedAt).isBetween(\r\n        moment(`${year}-04-01`),\r\n        moment(`${year+1}-04-01`),\r\n        undefined, \"[)\")\r\n      ).reverse();\r\n    };\r\n\r\n    \r\n\r\n    const displayDate = dateStr => moment(dateStr).format(\"YYYY/MM/DD\");\r\n    const kansouStaff = computed(() => store.state.user.is_staff);\r\n\r\n    return {\r\n      yearsSet, kansouStaff, kansou, years,\r\n      getItems, displayDate\r\n    };\r\n\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card {\r\n  margin-bottom: 0.5rem;\r\n}\r\n.pure-menu-heading {\r\n  border-color: $bg-light!important;\r\n}\r\n.kansou-item {\r\n  padding: 0.5em 1em;\r\n  line-height: 1.5;\r\n  time {\r\n    padding: 0 0.5rem;\r\n  }\r\n}\r\n</style>","import { render } from \"./index.vue?vue&type=template&id=49ef6cc2&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=49ef6cc2&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\mhash\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-49ef6cc2\"]])\n\nexport default __exports__"],"names":["class","yearsSet","year","key","getItems","item","id","href","target","title","size","datetime","performedAt","displayDate","detail","setup","store","kansou","axios","then","res","length","push","data","catch","error","console","response","commit","level","message","appname","years","map","date","moment","isBefore","set","month","day","value","filter","x","i","self","indexOf","reverse","isBetween","undefined","dateStr","format","kansouStaff","state","user","is_staff","__exports__","render"],"sourceRoot":""}