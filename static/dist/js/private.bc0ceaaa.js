(function(){var e={7355:function(e,t,n){var s={"./ja":9183,"./ja.js":9183,"moment/locale/ja":9183,"moment/locale/ja.js":9183};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=o,e.exports=a,a.id=7355},6719:function(e,t,n){"use strict";var s=n(9963),a=n(6252);const o={id:"nav"},r=(0,a.Uk)("Home"),i=(0,a.Uk)(" | "),m=(0,a.Uk)("Photo"),d=(0,a.Uk)(" | "),l=(0,a.Uk)("Sound"),c=(0,a.Uk)(" | "),u=(0,a.Uk)("Kansou"),p=(0,a.Uk)(" | "),g=(0,a.Uk)("Mypage"),f=(0,a.Uk)(" | "),h=(0,a.Uk)("Read - index"),v=(0,a.Uk)(" | "),y=(0,a.Uk)("Send"),b={class:"container"};function _(e,t,n,s,_,k){const w=(0,a.up)("router-link"),O=(0,a.up)("router-view"),j=(0,a.up)("message");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[(0,a.Wm)(w,{to:"/"},{default:(0,a.w5)((()=>[r])),_:1}),i,(0,a.Wm)(w,{to:"/photo"},{default:(0,a.w5)((()=>[m])),_:1}),d,(0,a.Wm)(w,{to:"/sound"},{default:(0,a.w5)((()=>[l])),_:1}),c,(0,a.Wm)(w,{to:"/kansou"},{default:(0,a.w5)((()=>[u])),_:1}),p,(0,a.Wm)(w,{to:"/mypage"},{default:(0,a.w5)((()=>[g])),_:1}),f,(0,a.Wm)(w,{to:"/mail"},{default:(0,a.w5)((()=>[h])),_:1}),v,(0,a.Wm)(w,{to:"/mail/send"},{default:(0,a.w5)((()=>[y])),_:1})]),(0,a._)("main",b,[(0,a.Wm)(O)]),(0,a.Wm)(j)],64)}var k=n(8410),w=n(3577);const O={class:"message-wraper"},j=["onClick"];function P(e,t,n,o,r,i){return(0,a.wg)(),(0,a.iD)("div",O,[(0,a.Wm)(s.W3,{name:"message"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.displaying,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:(0,w.C_)(["popup-message",[o.select(e).level]])},[(0,a._)("button",{onClick:t=>o.close(e),class:"popup-close"},null,8,j),(0,a.Uk)(" "+(0,w.zw)(o.select(e).message),1)],2)))),128))])),_:1})])}var C=n(2262);const U=5e3;var A={name:"message",setup(){const e=(0,k.oR)(),t=(0,C.Fl)((()=>e.state.message.messages)),n=(0,C.Fl)((()=>{const e=Object.keys(t.value);return e.filter((e=>!t.value[e].completed&&!t.value[e].displayed))})),s=(0,C.Fl)((()=>{const e=Object.keys(t.value);return e.filter((e=>!t.value[e].completed&&t.value[e].displayed))}));(0,a.m0)((()=>{for(const t of n.value)e.commit("message/displayed",t),setTimeout((()=>{e.commit("message/completed",t)}),U)}));const o=e=>t.value[e],r=t=>e.commit("message/completed",t);return{messages:t,before_display:n,displaying:s,select:o,close:r}}},L=n(3744);const I=(0,L.Z)(A,[["render",P],["__scopeId","data-v-3d11049c"]]);var Z=I,M={components:{message:Z},setup(){const e=(0,k.oR)();(0,a.bv)(e.dispatch("mypage/getUserInfo"))}};const E=(0,L.Z)(M,[["render",_]]);var S=E,x=n(6476),F=n(2119);const T=[{path:"/",name:"Home",component:()=>n.e(177).then(n.bind(n,6628))},{path:"/mail",name:"mail:index",component:()=>n.e(886).then(n.bind(n,9691))},{path:"/mail/:id(\\d+)",name:"mail:content",component:()=>n.e(886).then(n.bind(n,561)),props:e=>({id:Number(e.params.id)})},{path:"/mail/send",name:"mail:send",component:()=>n.e(963).then(n.bind(n,8808))},{path:"/mail/send/confirm",name:"mail:send-confirm",component:()=>n.e(963).then(n.bind(n,5276))},{path:"/photo",name:"photo:index",component:()=>n.e(17).then(n.bind(n,3655))},{path:"/sound",name:"sound:index",component:()=>n.e(460).then(n.bind(n,2519))},{path:"/sound/:id(\\d+)",name:"sound:content",component:()=>n.e(460).then(n.bind(n,5918)),props:e=>({id:Number(e.params.id)})},{path:"/kansou",name:"kansou:index",component:()=>n.e(941).then(n.bind(n,97))},{path:"/mypage",name:"mypage:index",component:()=>n.e(767).then(n.bind(n,8929))},{path:"/mypage/profile",name:"mypage:profile",component:()=>n.e(767).then(n.bind(n,5741))},{path:"/mypage/mail-settings",name:"mypage:mail-settings",component:()=>n.e(767).then(n.bind(n,8301))},{path:"/mypage/mail-test",name:"mypage:mail-test",component:()=>n.e(767).then(n.bind(n,9866))},{path:"/mypage/oauth",name:"mypage:oauth",component:()=>n.e(767).then(n.bind(n,2711))}],N=(0,F.p7)({history:(0,F.PO)("/"),routes:T,base:"/"});N.beforeEach(((e,t,n)=>{if("/"!==e.path.slice(-1))return n(`${e.path}/`);x.Z.commit("updateLastPath",t),n()}));var W=N;(0,s.ri)(S).use(W).use(x.Z).mount("#app")},6476:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var s=n(8410),a=n(1955),o={namespaced:!0,state:{messages:{}},mutations:{storeMessageFromCokie(e){const t=a.Z.get(),n=/^message_\d\d\d\d\d\d\d\d\d\d_\d\d_/,s=Object.keys(t).filter((e=>n.test(e)));for(const o of s){const s=o.replace(n,"");e.messages={...e.messages,[o]:{level:s,message:t[o],displayed:!1,completed:!1}},a.Z.remove(o)}},displayed(e,t){Object.hasOwnProperty.call(e.messages,t)&&(e.messages[t]={...e.messages[t],displayed:!0})},completed(e,t){Object.hasOwnProperty.call(e.messages,t)&&(e.messages[t]={...e.messages[t],completed:!0})},addMessage(e,t){const n=`local_${t.appname}${String(Object.keys(e.messages).length+1)}`;e.messages={...e.messages,[n]:{level:t.level,message:t.message,displayed:!1,completed:!1}}}}},r=n(8042),i={namespaced:!0,state:{id:null,shortname:"",year:null,is_staff:!1,data_fetched:null},mutations:{set(e,t){const n=["id","shortname","year","is_staff"];for(const s of n)e[s]=t[s];e.data_fetched=new Date}},actions:{getUserInfo(e){r.Z.get("/api/mypage/user/").then((t=>{e.commit("set",t.data)}))}}},m={namespaced:!0,state:{messages:[],params:{},nowLoading:!1},mutations:{setMessages(e,t){e.messages.length=0,e.messages=t},startAPILoading(e){e.nowLoading=!0,console.log("startAPILoading")},finishAPILoading(e){e.nowLoading=!1,console.log("finishAPILoading")},updateBookmarked(e,t){const n=e.messages.find((e=>e.id===t.id));n&&(n.is_bookmarked=t.bool)},updateParams(e,t){e.params=t}},actions:{getMessagesFromAPI(e,t){e.commit("startAPILoading"),r.Z.get("/api/board/json/",{params:t}).then((n=>{e.commit("setMessages",n.data.message_list),e.commit("updateParams",t)})).catch((e=>{console.log("name",e.name),console.log("message",e.message),console.log("response",e.response),console.log("response.status",e.response.status)})).finally((()=>{e.commit("finishAPILoading")}))},async loadOneMessage(e,t){e.commit("startAPILoading");const n=await r.Z.get(`/api/board/content/${String(t)}/`).catch((e=>{console.log("name",e.name),console.log("message",e.message),console.log("response",e.response),console.log("response.status",e.response.status)}));return e.commit("finishAPILoading"),e.commit("setMessages",[n.data.message]),n.data.message},toggleBookmark(e,t){const n=e.state.messages.find((e=>e.id===t));e.commit("updateBookmarked",{id:t,bool:!n.is_bookmarked}),r.Z.post(`/api/board/bookmark/${String(t)}/`,{data:"data"}).then((n=>{e.commit("updateBookmarked",{id:t,bool:"true"===n.data["updated-to"]})}))}}};function d(e){const t=[];return e.length<1&&t.push("タイトルを入力してください"),e.length>200&&t.push("タイトルが長すぎます"),t}function l(e){const t=[];return e.length<1&&t.push("本文を入力してください"),t}function c(e){const t=[];return e||t.push("差出人を指定してください"),t}function u(e){const t=[];return null===e?["宛先を指定してください"]:(e&&0!==e.length||t.push("宛先を指定してください"),t)}function p(e){const t=[];if(0===e.length)return[];let n=0;for(const s of e)s.size||t.push("ファイルが無効です"),s.size<0&&t.push("ファイルが無効です(zero file size)"),s.size>1e7&&t.push(`ファイルサイズが上限(10MB)を超えています：${s.name}`),n+=s.size;return n>20971520&&t.push("合計のファイルサイズが上限(20MB)を超えています"),t}var g={namespaced:!0,state:{title:{value:"",is_dirty:!1,error_messages:[]},content:{value:"",is_dirty:!1,error_messages:[]},tos:{value:[],is_dirty:!1,error_messages:[]},writer:{value:null,is_dirty:!1,error_messages:[]},attachments:{value:[],is_dirty:!1,error_messages:[]},send_at:{value:null,is_dirty:!1,error_messages:[]}},mutations:{setTitle(e,t){e.title.value=t,e.title.error_messages=d(e.title.value),e.title.is_dirty=!0},setContent(e,t){e.content.value=t,e.content.error_messages=l(e.content.value),e.content.is_dirty=!0},setTos(e,t){e.tos.value=t,e.tos.error_messages=u(e.tos.value),e.tos.is_dirty=!0},setWriter(e,t){e.writer.value=t,e.writer.error_messages=c(e.writer.value),e.writer.is_dirty=!0},setAttachments(e,t){e.attachments.value=t,e.attachments.error_messages=p(e.attachments.value),e.attachments.is_dirty=!0},validateAll(e){e.title.error_messages=d(e.title.value),e.content.error_messages=l(e.content.value),e.writer.error_messages=c(e.writer.value),e.attachments.error_messages=p(e.attachments.value),e.title.is_dirty=!0,e.content.is_dirty=!0,e.writer.is_dirty=!0,e.attachments.is_dirty=!0}},getters:{isValid(e){return!e.title.error_messages.length&&!e.content.error_messages.length&&!e.tos.error_messages.length&&!e.writer.error_messages.length&&!e.attachments.error_messages.length&&!e.send_at.error_messages.length},isValidAndDirty(e,t){return t.isValid&&e.title.is_dirty&&e.content.is_dirty}},actions:{send(e){if(e.commit("validateAll"),!e.getters.isValid)return e.commit("message/addMessage",{level:"error",message:"不正なフィールドがあり、送信できませんでした。",appname:"mail/send"},{root:!0}),Promise.reject(new Error("form validation error"));const t=new FormData;return t.append("title",e.state.title.value),t.append("content",e.state.content.value),e.state.tos.value.forEach((e=>{t.append("to",e.year)})),t.append("writer",e.state.writer.value.id),e.state.attachments.value.forEach((e=>{t.append("attachments",e)})),r.Z.post("/api/board/send/send/",t,{onUploadProgress:e=>console.log(e)}).then((t=>(console.log(t),e.commit("message/addMessage",{level:"info",message:"送信されました。",appname:"mail/send"},{root:!0}),t)))}}},f=n(5492),h={namespaced:!0,state:{lives:[],updated:null},mutations:{set(e,t){e.lives.length=0,e.lives.push(...t),e.updated=(0,f.Z)()}},actions:{getSoundsFromAPI(e){(0==e.state.lives.length||e.state.updated.isBefore((0,f.Z)().subtract(1,"hours")))&&r.Z.get("/api/sound/").then((t=>{e.commit("set",t.data.lives)}))},loadOneSoundContent(e){r.Z.get("/api/sound/").then((t=>{e.commit("set",t.data.lives)}))}}},v={namespaced:!0,state:{loading:!1,userInfo:{}},mutations:{setLoading(e,t){e.loading=t},setUserInfo(e,t){e.userInfo={...t}}},actions:{post(e,t){e.commit("setLoading",!0);const{path:n,formData:s}=t,a={"content-type":"multipart/form-data"};r.Z.post(n,s,{headers:a}).then((t=>{e.commit("setUserInfo",t.data.userInfo)})).catch((e=>{e.response})).finally((()=>{e.commit("setLoading",!1)}))},getUserInfo(e){r.Z.get("/api/mypage/user/").then((t=>{e.commit("setUserInfo",t.data.userInfo)}))}}},y=(0,s.MT)({strict:!1,state:{lastPath:null},mutations:{updateLastPath(e,t){e.lastPath=t}},actions:{},modules:{message:o,user:i,read:m,send:g,sound:h,mypage:v}})},8042:function(e,t,n){"use strict";var s=n(9669),a=n.n(s),o=n(6476);const r=a().create({headers:{"X-Requested-With":"XMLHttpRequest"},xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFTOKEN"});r.interceptors.response.use((e=>(o.Z.commit("message/storeMessageFromCokie"),e)),(e=>(o.Z.commit("message/storeMessageFromCokie"),Promise.reject(e)))),t["Z"]=r},5492:function(e,t,n){"use strict";var s=n(381),a=n.n(s);n(9183);a()().format(),a()().locale("ja"),t["Z"]=a()}},t={};function n(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,function(){var e=[];n.O=function(t,s,a,o){if(!s){var r=1/0;for(l=0;l<e.length;l++){s=e[l][0],a=e[l][1],o=e[l][2];for(var i=!0,m=0;m<s.length;m++)(!1&o||r>=o)&&Object.keys(n.O).every((function(e){return n.O[e](s[m])}))?s.splice(m--,1):(i=!1,o<r&&(r=o));if(i){e.splice(l--,1);var d=a();void 0!==d&&(t=d)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[s,a,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,s){return n.f[s](e,t),t}),[]))}}(),function(){n.u=function(e){return"static/dist/js/"+{17:"photo",177:"home",460:"sound",767:"mypage",886:"read",941:"kansou",963:"send"}[e]+"."+{17:"bcd67ea7",177:"0da71431",460:"79cf06f6",767:"8ee63b5e",886:"cdd4e8b6",941:"552199c8",963:"e2dd6057"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"static/dist/css/"+{17:"photo",460:"sound",886:"read",963:"send"}[e]+"."+{17:"91e2ff7f",460:"4d65feb7",886:"4cb1c27a",963:"08efd004"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="front:";n.l=function(s,a,o,r){if(e[s])e[s].push(a);else{var i,m;if(void 0!==o)for(var d=document.getElementsByTagName("script"),l=0;l<d.length;l++){var c=d[l];if(c.getAttribute("src")==s||c.getAttribute("data-webpack")==t+o){i=c;break}}i||(m=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+o),i.src=s),e[s]=[a];var u=function(t,n){i.onerror=i.onload=null,clearTimeout(p);var a=e[s];if(delete e[s],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),m&&document.head.appendChild(i)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.j=58}(),function(){n.p="/"}(),function(){var e=function(e,t,n,s){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css";var o=function(o){if(a.onerror=a.onload=null,"load"===o.type)n();else{var r=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.href||t,m=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");m.code="CSS_CHUNK_LOAD_FAILED",m.type=r,m.request=i,a.parentNode.removeChild(a),s(m)}};return a.onerror=a.onload=o,a.href=t,document.head.appendChild(a),a},t=function(e,t){for(var n=document.getElementsByTagName("link"),s=0;s<n.length;s++){var a=n[s],o=a.getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(o===e||o===t))return a}var r=document.getElementsByTagName("style");for(s=0;s<r.length;s++){a=r[s],o=a.getAttribute("data-href");if(o===e||o===t)return a}},s=function(s){return new Promise((function(a,o){var r=n.miniCssF(s),i=n.p+r;if(t(r,i))return a();e(s,i,a,o)}))},a={58:0};n.f.miniCss=function(e,t){var n={17:1,460:1,886:1,963:1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=s(e).then((function(){a[e]=0}),(function(t){throw delete a[e],t})))}}(),function(){var e={58:0};n.f.j=function(t,s){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)s.push(a[2]);else{var o=new Promise((function(n,s){a=e[t]=[n,s]}));s.push(a[2]=o);var r=n.p+n.u(t),i=new Error,m=function(s){if(n.o(e,t)&&(a=e[t],0!==a&&(e[t]=void 0),a)){var o=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",i.name="ChunkLoadError",i.type=o,i.request=r,a[1](i)}};n.l(r,m,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,s){var a,o,r=s[0],i=s[1],m=s[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(m)var l=m(n)}for(t&&t(s);d<r.length;d++)o=r[d],n.o(e,o)&&e[o]&&e[o][0](),e[r[d]]=0;return n.O(l)},s=self["webpackChunkfront"]=self["webpackChunkfront"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(6719)}));s=n.O(s)})();
//# sourceMappingURL=private.bc0ceaaa.js.map