{"version":3,"file":"../static/dist/js/kansou.c8ea6cb9.js","mappings":"oPAEI,OAAa,UAAT,QAAI,K,GAEFA,MAAM,qB,GACNA,MAAM,kB,oCAaJ,OAAM,qB,GACAA,MAAM,S,0CAlBtB,QAyBU,gBAxBR,IAwBQ,aAvBR,QAsBU,mBAtBc,EAAAC,UAARC,K,WAAhB,QAsBU,WAtByBC,IAAKD,EAAMF,MAAM,yBAApD,EACE,OAA+C,KAA/C,GAA+C,QAAdE,GAAO,KAAE,IAC1C,OAmBK,KAnBL,EAmBK,gBAlBH,QAiBK,mBAhBY,EAAAE,SAASF,IAAjBG,K,WADT,QAiBK,MAfFF,IAAKE,EAAKC,GACXN,MAAM,8BAHR,EAKE,OAEI,KAFAO,KAAI,oBAAsBF,EAAKC,MAAOE,OAAO,WAAjD,QACKH,EAAKI,OAAQ,OAAG,QAAGJ,EAAKK,MAAO,MACpC,MACA,OAEO,QAFAC,SAAUN,EAAKO,YAAaZ,MAAM,UAAzC,QACK,EAAAa,YAAYR,EAAKO,cAAW,KAEjBP,EAAKS,SAAA,WAArB,QAKW,cAJT,GACA,OAEO,OAFP,GAEO,QADFT,EAAKS,QAAM,IAHlB,0BAXF,aAHJ,Q,4CA+BJ,GACEC,QACE,MAAMC,GAAQ,UACRC,GAAS,QAAS,IAExBC,EAAA,MACO,gBACJC,MAAMC,IACLH,EAAOI,OAAS,EAChBJ,EAAOK,QAAQF,EAAIG,KAAKN,WAEzBO,OAAOC,IACNC,QAAQD,MAAMA,EAAME,UACpBX,EAAMY,OAAO,qBAAsB,CACjCC,MAAO,UACPC,QAAS,uBACTC,QAAS,oBAIf,MAAMC,GAAQ,SAAS,IACrBf,EAAOgB,KAAK5B,IACV,MAAM6B,GAAO,EAAAC,EAAA,GAAO9B,EAAKO,aACzB,IAAIV,EAAO,EAQX,OAJEA,EAFAgC,EAAKE,UAAS,EAAAD,EAAA,KAASE,IAAI,CAAEnC,KAAMgC,EAAKhC,OAAQoC,MAAO,EAAGC,IAAK,KAExDL,EAAKhC,OAAS,EAEdgC,EAAKhC,OAEPA,OAGLD,GAAW,SAAS,IACxB+B,EAAMQ,MAAMC,QAAO,CAACC,EAAGC,EAAGC,IAASA,EAAKC,QAAQH,KAAOC,IAAGG,YAItD1C,EAAYF,GACTe,EACJwB,QAAQpC,IACP,EAAA8B,EAAA,GAAO9B,EAAKO,aAAamC,WACvB,EAAAZ,EAAA,GAAQ,GAAEjC,YACV,EAAAiC,EAAA,GAAQ,GAAEjC,EAAO,gBACjB8C,EACA,QAGHF,UAGCjC,EAAeoC,IAAY,EAAAd,EAAA,GAAOc,GAASC,OAAO,cAClDC,GAAc,SAAS,IAAMnC,EAAMoC,MAAMC,KAAKC,WAEpD,MAAO,CACLrD,SAAAA,EACAkD,YAAAA,EACAlC,OAAAA,EACAe,MAAAA,EACA5B,SAAAA,EACAS,YAAAA,K,UCxFN,MAAM0C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF","sources":["webpack://front/./src/pages/kansou/index.vue","webpack://front/./src/pages/kansou/index.vue?01cc"],"sourcesContent":["<template>\r\n  <article>\r\n    <h3>感想用紙</h3>\r\n    <section v-for=\"year in yearsSet\" :key=\"year\" class=\"pure-menu-custom card\">\r\n      <h4 class=\"pure-menu-heading\">{{ year }}年度</h4>\r\n      <ul class=\"pure-menu-list\">\r\n        <li\r\n          v-for=\"item in getItems(year)\"\r\n          :key=\"item.id\"\r\n          class=\"pure-menu-item kansou-item\"\r\n        >\r\n          <a :href=\"`/download/kansou/${item.id}/`\" target=\"_blank\">\r\n            {{ item.title }} ( {{ item.size }} )\r\n          </a>\r\n          <time :datetime=\"item.performedAt\" class=\"small\">\r\n            {{ displayDate(item.performedAt) }}\r\n          </time>\r\n          <template v-if=\"item.detail\">\r\n            <br />\r\n            <span class=\"small\">\r\n              {{ item.detail }}\r\n            </span>\r\n          </template>\r\n        </li>\r\n      </ul>\r\n    </section>\r\n  </article>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"../../utils/moment\";\r\nimport { computed, reactive } from \"vue\";\r\nimport axios from \"../../utils/axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const kansou = reactive([]);\r\n\r\n    axios\r\n      .get(\"/api/kansou/\")\r\n      .then((res) => {\r\n        kansou.length = 0;\r\n        kansou.push(...res.data.kansou);\r\n      })\r\n      .catch((error) => {\r\n        console.error(error.response);\r\n        store.commit(\"message/addMessage\", {\r\n          level: \"warning\",\r\n          message: \"感想用紙のデータを取得できませんでした。\",\r\n          appname: \"kansou/index\",\r\n        });\r\n      });\r\n\r\n    const years = computed(() =>\r\n      kansou.map((item) => {\r\n        const date = moment(item.performedAt);\r\n        let year = 0;\r\n        if (\r\n          date.isBefore(moment().set({ year: date.year(), month: 3, day: 1 }))\r\n        ) {\r\n          year = date.year() - 1; //                       month:3 => 4月\r\n        } else {\r\n          year = date.year();\r\n        }\r\n        return year;\r\n      })\r\n    );\r\n    const yearsSet = computed(() =>\r\n      years.value.filter((x, i, self) => self.indexOf(x) === i).reverse()\r\n    );\r\n    // 重複しない年度の数字を取得\r\n\r\n    const getItems = (year) => {\r\n      return kansou\r\n        .filter((item) =>\r\n          moment(item.performedAt).isBetween(\r\n            moment(`${year}-04-01`),\r\n            moment(`${year + 1}-04-01`),\r\n            undefined,\r\n            \"[)\"\r\n          )\r\n        )\r\n        .reverse();\r\n    };\r\n\r\n    const displayDate = (dateStr) => moment(dateStr).format(\"YYYY/MM/DD\");\r\n    const kansouStaff = computed(() => store.state.user.is_staff);\r\n\r\n    return {\r\n      yearsSet,\r\n      kansouStaff,\r\n      kansou,\r\n      years,\r\n      getItems,\r\n      displayDate,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card {\r\n  margin-bottom: 0.5rem;\r\n}\r\n.kansou-item {\r\n  padding: 0.5em 1em;\r\n  line-height: 1.5;\r\n  time {\r\n    padding: 0 0.5rem;\r\n  }\r\n}\r\n</style>","import { render } from \"./index.vue?vue&type=template&id=244f9831&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=244f9831&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\mhash\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-244f9831\"]])\n\nexport default __exports__"],"names":["class","yearsSet","year","key","getItems","item","id","href","target","title","size","datetime","performedAt","displayDate","detail","setup","store","kansou","axios","then","res","length","push","data","catch","error","console","response","commit","level","message","appname","years","map","date","moment","isBefore","set","month","day","value","filter","x","i","self","indexOf","reverse","isBetween","undefined","dateStr","format","kansouStaff","state","user","is_staff","__exports__","render"],"sourceRoot":""}