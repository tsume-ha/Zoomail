{"version":3,"file":"static/dist/js/photo.584cc4ff.js","mappings":"mPAEI,OAAW,UAAP,MAAE,K,UACN,OAGI,KAHDA,MAAM,QAAM,UAAC,2BACO,OAAI,OADZ,QACY,6CAD3B,K,SAIKA,MAAM,O,UACT,OAAqD,KAAlDC,KAAK,0BAAyB,oBAAgB,K,GAAjD,G,GAGID,MAAM,U,GAECA,MAAM,Q,iFAZrB,QAqBU,gBApBR,EACA,EAIuB,EAAAE,aAAA,WAAvB,QAEM,MAFN,EAEM,KAFN,iBAeQ,aAZR,QAWM,mBAXW,EAAAC,UAALC,K,WAAZ,QAWM,OAXsBC,IAAKD,EAAGJ,MAAM,OAA1C,EACE,OAA+B,KAA/B,GAA+B,QAAVI,GAAG,KAAE,KAA1B,aACA,QAQM,mBARc,EAAAE,SAASF,IAAjBG,K,WAAZ,QAQM,OAR4BF,IAAKE,EAAKC,GAAIR,MAAM,2DAAtD,EACE,OAMU,UANV,EAMU,EALR,OAAuD,OAAlDA,MAAM,eAAgBS,IAAK,EAAAC,cAAcH,IAA9C,WACA,OAGI,KAHAN,KAAMM,EAAKI,IAAKX,MAAM,mBAAmBY,OAAO,UAApD,EACE,OAAgD,MAA5CZ,MAAM,a,aAAa,QAAmB,EAANa,QAApC,WACA,OAAyC,qBAAhC,EAAAC,YAAYP,EAAKQ,OAAI,IAFhC,YAHJ,WAFF,Q,4CAoBJ,GACEC,QACE,MAAMC,GAAQ,UACRC,GAAS,QAAS,IAExBC,EAAA,MAAU,eAAeC,MAAKC,IAC5BH,EAAOI,OAAS,EAChBJ,EAAOK,QAAQF,EAAIG,KAAKN,WACvBO,OAAMC,IACPC,QAAQD,MAAMA,EAAME,UACpBX,EAAMY,OAAO,qBAAsB,CACjCC,MAAO,UACPC,QAAS,mBACTC,QAAS,oBAIb,MAAMC,GAAQ,SAAS,IAAMf,EAAOgB,KAAI3B,IACtC,MAAMQ,GAAO,EAAAoB,EAAA,GAAO5B,EAAKQ,MACzB,IAAIqB,EAAO,EAMX,OAJEA,EADErB,EAAKsB,UAAS,EAAAF,EAAA,KAASG,IAAI,CAACF,KAAKrB,EAAKqB,OAAQG,MAAM,EAAGC,IAAI,KACtDzB,EAAKqB,OAAS,EAEdrB,EAAKqB,OAEPA,OAEHjC,GAAW,SAAS,IAAM8B,EAAMQ,MAAMC,QAC1C,CAACC,EAAGC,EAAGC,IAASA,EAAKC,QAAQH,KAAOC,IACpCG,YAGIzC,EAAW8B,GACRlB,EAAOwB,QAAOnC,IAAQ,EAAA4B,EAAA,GAAO5B,EAAKQ,MAAMiC,WAC7C,EAAAb,EAAA,GAAQ,GAAEC,YACV,EAAAD,EAAA,GAAQ,GAAEC,EAAK,gBACfa,EAAW,QACXF,UAKEjC,EAAcoC,IAAW,EAAAf,EAAA,GAAOe,GAASC,OAAO,cAChDzC,EAAgBH,GAChBA,EAAK6C,UACA7C,EAAK6C,UAEL,qCAILlD,GAAa,SAAS,IAAMe,EAAMoC,MAAMC,KAAKC,WAEnD,MAAO,CACLrC,OAAAA,EAAQe,MAAAA,EAAO9B,SAAAA,EAAUD,WAAAA,EACzBI,SAAAA,EAAUQ,YAAAA,EAAaJ,cAAAA,K,UC9E7B,MAAM8C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF","sources":["webpack://front/./src/pages/photo/index.vue","webpack://front/./src/pages/photo/index.vue?10b1"],"sourcesContent":["<template>\r\n  <section>\r\n    <h3>写真</h3>\r\n    <p class=\"py-2\">\r\n      アンプラのイベントの写真を公開しています。<br>\r\n      LiveLogに登録されていないBBQやお花見のイベントの写真もあります！\r\n    </p>\r\n    <div class=\"row\" v-if=\"photoStaff\" v-cloak>\r\n      <a href=\"/admin/pictures/album/\">アルバムの登録・編集はこちらから</a>\r\n    </div>\r\n    <div v-for=\"y in yearsSet\" :key=\"y\" class=\"row\">\r\n      <h4 class=\"col-12\">{{y}}年度</h4>\r\n      <div v-for=\"item in getItems(y)\" :key=\"item.id\" class=\"cardwrap col-6 col-xs-6 col-sm-6 col-md-4 col-lg-3 my-2\">\r\n        <article class=\"card\">\r\n          <img class=\"card-img-top\" :src=\"thumbnailPath(item)\" />\r\n          <a :href=\"item.url\" class=\"card-img-overlay\" target=\"_blank\">\r\n            <h5 class=\"card-title\" v-text=\"item.title\"></h5>\r\n            <span>{{ displayDate(item.date) }}</span>\r\n          </a>\r\n        </article>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"../../utils/moment\";\r\nimport { computed, reactive } from \"vue\";\r\nimport axios from \"../../utils/axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const photos = reactive([]);\r\n\r\n    axios.get(\"/api/photo/\").then(res => {\r\n      photos.length = 0;\r\n      photos.push(...res.data.photos);\r\n    }).catch(error => {\r\n      console.error(error.response);\r\n      store.commit(\"message/addMessage\", {\r\n        level: \"warning\",\r\n        message: \"アルバムを取得できませんでした。\",\r\n        appname: \"photos/index\"\r\n      });\r\n    });\r\n\r\n    const years = computed(() => photos.map(item => {\r\n      const date = moment(item.date);\r\n      let year = 0;\r\n      if (date.isBefore(moment().set({year:date.year(), month:3, day:1}))) {\r\n        year = date.year() - 1;//                       month:3 => 4月\r\n      } else {\r\n        year = date.year();\r\n      }\r\n      return year;\r\n    }));\r\n    const yearsSet = computed(() => years.value.filter(\r\n      (x, i, self) => self.indexOf(x) === i\r\n    ).reverse());\r\n    // 重複しない年度の数字を取得\r\n\r\n    const getItems = year => {\r\n      return photos.filter(item => moment(item.date).isBetween(\r\n        moment(`${year}-04-01`),\r\n        moment(`${year+1}-04-01`),\r\n        undefined, \"[)\")\r\n      ).reverse();\r\n    };\r\n\r\n    \r\n\r\n    const displayDate = dateStr => moment(dateStr).format(\"YYYY/MM/DD\");\r\n    const thumbnailPath = item => {\r\n      if (item.thumbnail) {\r\n        return item.thumbnail;\r\n      } else {\r\n        return \"/static/img/album_thum_default.jpg\";\r\n      }\r\n    };\r\n\r\n    const photoStaff = computed(() => store.state.user.is_staff);\r\n\r\n    return {\r\n      photos, years, yearsSet, photoStaff,\r\n      getItems, displayDate, thumbnailPath\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\na.card-img-overlay{\r\n  border-radius: 3px;\r\n  color: #fff;\r\n  background-color: rgba(0,0,0,0.3);\r\n  transition: 0.4s;\r\n}\r\n\r\na.card-img-overlay:after{\r\n  content: \"\";\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 3px;\r\n  box-shadow: inset 0 0 0px 5px rgba(255,255,255,0.5);\r\n}\r\n\r\na.card-img-overlay.hover{\r\n  text-decoration: none;\r\n  color: #000;\r\n  background-color: rgba(255,255,255,0.5);\r\n}\r\n\r\nh6.card-subtitle{\r\n  position: absolute;\r\n  right: 1rem;\r\n  bottom: 1rem;\r\n  font-size: 0.75rem;\r\n  font-weight: 400;\r\n  color: #fff;\r\n  transition: 0.4s;\r\n}\r\na.card-img-overlay.hover h6.card-subtitle{\r\n  color: #000;\r\n  text-decoration: none;\r\n}\r\n[v-cloak] {\r\n  display: none;\r\n}\r\n</style>","import { render } from \"./index.vue?vue&type=template&id=5d20ee12&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=5d20ee12&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\mhash\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5d20ee12\"]])\n\nexport default __exports__"],"names":["class","href","photoStaff","yearsSet","y","key","getItems","item","id","src","thumbnailPath","url","target","title","displayDate","date","setup","store","photos","axios","then","res","length","push","data","catch","error","console","response","commit","level","message","appname","years","map","moment","year","isBefore","set","month","day","value","filter","x","i","self","indexOf","reverse","isBetween","undefined","dateStr","format","thumbnail","state","user","is_staff","__exports__","render"],"sourceRoot":""}