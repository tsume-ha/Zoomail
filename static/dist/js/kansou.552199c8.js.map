{"version":3,"file":"static/dist/js/kansou.552199c8.js","mappings":"gMAK8D,OAAI,mB,0CAJhE,QAUO,4BATL,QAOU,mBAPc,EAAAA,UAARC,K,WAAhB,QAOU,WAPyBC,IAAKD,GAAI,EAC1C,OAAmB,mBAAbA,GAAM,KAAE,KAD4B,aAE1C,QAII,mBAJc,EAAAE,SAASF,IAAjBG,K,WAAV,QAII,KAJ+BF,IAAKE,EAAKC,IAA7C,EACE,OAAsD,KAAlDC,KAAMF,EAAKG,IAAKC,OAAO,WAA3B,QAAsCJ,EAAKK,OAAK,KAAM,WAAI,KAC1D,QAAEL,EAAKM,aAAW,QAFpB,WAFF,Q,4CAiBJ,GACEC,QACE,MAAMC,GAAQ,UACRC,GAAS,QAAS,IAExBC,EAAA,MAAU,gBAAgBC,MAAKC,IAC7BH,EAAOI,OAAS,EAChBJ,EAAOK,QAAQF,EAAIG,KAAKN,WACvBO,OAAMC,IACPC,QAAQD,MAAMA,EAAME,UACpBX,EAAMY,OAAO,qBAAsB,CACjCC,MAAO,UACPC,QAAS,uBACTC,QAAS,oBAIb,MAAMC,GAAQ,SAAS,IAAMf,EAAOgB,KAAIzB,IACtC,MAAM0B,GAAO,EAAAC,EAAA,GAAO3B,EAAK0B,MACzB,IAAI7B,EAAO,EAMX,OAJEA,EADE6B,EAAKE,UAAS,EAAAD,EAAA,KAASE,IAAI,CAAChC,KAAK6B,EAAK7B,OAAQiC,MAAM,EAAGC,IAAI,KACtDL,EAAK7B,OAAS,EAEd6B,EAAK7B,OAEPA,OAEHD,GAAW,SAAS,IAAM4B,EAAMQ,MAAMC,QAC1C,CAACC,EAAGC,EAAGC,IAASA,EAAKC,QAAQH,KAAOC,IACpCG,YAGIvC,EAAWF,GACRY,EAAOwB,QAAOjC,IAAQ,EAAA2B,EAAA,GAAO3B,EAAK0B,MAAMa,WAC7C,EAAAZ,EAAA,GAAQ,GAAE9B,YACV,EAAA8B,EAAA,GAAQ,GAAE9B,EAAK,gBACf2C,EAAW,QACXF,UAKEG,EAAcC,IAAW,EAAAf,EAAA,GAAOe,GAASC,OAAO,cAChDC,GAAc,SAAS,IAAMpC,EAAMqC,MAAMC,KAAKC,WAEpD,MAAO,CACLnD,SAAAA,EAAUgD,YAAAA,EACV7C,SAAAA,EAAU0C,YAAAA,K,UC7DhB,MAAMO,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE","sources":["webpack://front/./src/pages/kansou/index.vue","webpack://front/./src/pages/kansou/index.vue?01cc"],"sourcesContent":["<template>\r\n  <main>\r\n    <section v-for=\"year in yearsSet\" :key=\"year\">\r\n      <h4>{{year}}年度</h4>\r\n      <p v-for=\"item in getItems(year)\" :key=\"item.id\">\r\n        <a :href=\"item.url\" target=\"_blank\">{{item.title}}</a><br>\r\n        {{item.performedAt}}\r\n\r\n      </p>\r\n    </section>\r\n\r\n  </main>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"../../utils/moment\";\r\nimport { computed, reactive } from \"vue\";\r\nimport axios from \"../../utils/axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const kansou = reactive([]);\r\n\r\n    axios.get(\"/api/kansou/\").then(res => {\r\n      kansou.length = 0;\r\n      kansou.push(...res.data.kansou);\r\n    }).catch(error => {\r\n      console.error(error.response);\r\n      store.commit(\"message/addMessage\", {\r\n        level: \"warning\",\r\n        message: \"感想用紙のデータを取得できませんでした。\",\r\n        appname: \"kansou/index\"\r\n      });\r\n    });\r\n\r\n    const years = computed(() => kansou.map(item => {\r\n      const date = moment(item.date);\r\n      let year = 0;\r\n      if (date.isBefore(moment().set({year:date.year(), month:3, day:1}))) {\r\n        year = date.year() - 1;//                       month:3 => 4月\r\n      } else {\r\n        year = date.year();\r\n      }\r\n      return year;\r\n    }));\r\n    const yearsSet = computed(() => years.value.filter(\r\n      (x, i, self) => self.indexOf(x) === i\r\n    ).reverse());\r\n    // 重複しない年度の数字を取得\r\n\r\n    const getItems = year => {\r\n      return kansou.filter(item => moment(item.date).isBetween(\r\n        moment(`${year}-04-01`),\r\n        moment(`${year+1}-04-01`),\r\n        undefined, \"[)\")\r\n      ).reverse();\r\n    };\r\n\r\n    \r\n\r\n    const displayDate = dateStr => moment(dateStr).format(\"YYYY/MM/DD\");\r\n    const kansouStaff = computed(() => store.state.user.is_staff);\r\n\r\n    return {\r\n      yearsSet, kansouStaff,\r\n      getItems, displayDate\r\n    };\r\n\r\n  },\r\n};\r\n</script>","import { render } from \"./index.vue?vue&type=template&id=aed61b88\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Hashizume\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["yearsSet","year","key","getItems","item","id","href","url","target","title","performedAt","setup","store","kansou","axios","then","res","length","push","data","catch","error","console","response","commit","level","message","appname","years","map","date","moment","isBefore","set","month","day","value","filter","x","i","self","indexOf","reverse","isBetween","undefined","displayDate","dateStr","format","kansouStaff","state","user","is_staff","__exports__","render"],"sourceRoot":""}