{"version":3,"file":"js/photo.bc0ca7b2.js","mappings":"6PAEI,OAAW,UAAP,MAAE,K,UACN,OAGI,mBAHD,2BACoB,OAAM,OAEzB,QAFyB,6CAD7B,K,GAIKA,MAAM,U,wCAsBCA,MAAM,e,GACNA,MAAM,c,0CA7BpB,QAiCU,gBAhCR,EACA,GAIA,OA0BM,MA1BN,EA0BM,gBAzBJ,QAwBM,mBAvBY,EAAAC,QAATC,K,WADT,QAwBM,OAtBHC,IAAG,SAAaD,EAAME,GACvBJ,MAAM,qEAHR,EAQE,OAeI,KAfAK,KAAMH,EAAMI,IAAKN,MAAM,aAAaO,OAAO,UAA/C,CAEUL,EAAMM,YAAA,WADd,QAKE,O,MAHCC,IAAKP,EAAMM,UACXE,IAAG,GAAKR,EAAMS,gBACfX,MAAM,YAJR,wBAMA,QAKE,O,MAHAS,IAAA,EACCC,IAAG,GAAKR,EAAMS,gBACfX,MAAM,YAJR,YAMA,OAAkD,OAAlD,GAAkD,QAArBE,EAAMS,OAAK,IACxC,OAA6D,OAA7D,GAA6D,QAAjC,EAAAC,YAAYV,EAAMW,OAAI,IAdpD,UARF,U,4CAkCN,GACEC,QACE,MAAMC,GAAQ,UACRd,GAAS,QAAS,IAExBe,EAAA,MACO,eACJC,MAAMC,IACLjB,EAAOkB,OAAS,EAChBlB,EAAOmB,QAAQF,EAAIG,KAAKpB,WAEzBqB,OAAOC,IACNC,QAAQD,MAAMA,EAAME,UACpBV,EAAMW,OAAO,qBAAsB,CACjCC,MAAO,UACPC,QAAS,mBACTC,QAAS,oBAIf,MAAMC,GAAQ,SAAS,IACrB7B,EAAO8B,KAAKC,IACV,MAAMnB,GAAO,EAAAoB,EAAA,GAAOD,EAAKnB,MACzB,IAAIqB,EAAO,EAQX,OAJEA,EAFArB,EAAKsB,UAAS,EAAAF,EAAA,KAASG,IAAI,CAAEF,KAAMrB,EAAKqB,OAAQG,MAAO,EAAGC,IAAK,KAExDzB,EAAKqB,OAAS,EAEdrB,EAAKqB,OAEPA,OAGLK,GAAW,SAAS,IACxBT,EAAMU,MAAMC,QAAO,CAACC,EAAGC,EAAGC,IAASA,EAAKC,QAAQH,KAAOC,IAAGG,YAItDC,EAAYb,GACTjC,EACJwC,QAAQT,IACP,EAAAC,EAAA,GAAOD,EAAKnB,MAAMmC,WAChB,EAAAf,EAAA,GAAQ,GAAEC,YACV,EAAAD,EAAA,GAAQ,GAAEC,EAAO,gBACjBe,EACA,QAGHH,UAGClC,EAAesC,IAAY,EAAAjB,EAAA,GAAOiB,GAASC,OAAO,cAClDC,EAAiBpB,GACjBA,EAAKxB,UACAwB,EAAKxB,UAEL,qCAIL6C,GAAa,SAAS,IAAMtC,EAAMuC,MAAMC,KAAKC,WAEnD,MAAO,CACLvD,OAAAA,EACA6B,MAAAA,EACAS,SAAAA,EACAc,WAAAA,EACAN,SAAAA,EACAnC,YAAAA,EACAwC,cAAAA,K,UCzGN,MAAMK,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,S","sources":["webpack://front/./src/pages/photo/index.vue","webpack://front/./src/pages/photo/index.vue?f08f"],"sourcesContent":["<template>\r\n  <article>\r\n    <h3>写真</h3>\r\n    <p>\r\n      アンプラのイベントの写真を公開しています。<br />\r\n      LiveLogに登録されていないBBQやお花見のイベントの写真もあります!\r\n    </p>\r\n    <div class=\"pure-g\">\r\n      <div\r\n        v-for=\"photo in photos\"\r\n        :key=\"'photo-' + photo.id\"\r\n        class=\"\r\n          pure-u-1-2 pure-u-sm-1-3 pure-u-md-1-4 pure-u-lg-1-5\r\n          card-wrapper\r\n        \"\r\n      >\r\n        <a :href=\"photo.url\" class=\"card-photo\" target=\"_blank\">\r\n          <img\r\n            v-if=\"photo.thumbnail\"\r\n            :src=\"photo.thumbnail\"\r\n            :alt=\"`${photo.title} - サムネイル`\"\r\n            class=\"pure-img\"\r\n          />\r\n          <img\r\n            v-else\r\n            src=\"@/assets/img/unplugged_logo.jpg\"\r\n            :alt=\"`${photo.title} - サムネイル`\"\r\n            class=\"pure-img\"\r\n          />\r\n          <span class=\"photo-title\">{{ photo.title }}</span>\r\n          <span class=\"photo-date\">{{ displayDate(photo.date) }}</span>\r\n        </a>\r\n      </div>\r\n    </div>\r\n  </article>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"../../utils/moment\";\r\nimport { computed, reactive } from \"vue\";\r\nimport axios from \"../../utils/axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const photos = reactive([]);\r\n\r\n    axios\r\n      .get(\"/api/photo/\")\r\n      .then((res) => {\r\n        photos.length = 0;\r\n        photos.push(...res.data.photos);\r\n      })\r\n      .catch((error) => {\r\n        console.error(error.response);\r\n        store.commit(\"message/addMessage\", {\r\n          level: \"warning\",\r\n          message: \"アルバムを取得できませんでした。\",\r\n          appname: \"photos/index\",\r\n        });\r\n      });\r\n\r\n    const years = computed(() =>\r\n      photos.map((item) => {\r\n        const date = moment(item.date);\r\n        let year = 0;\r\n        if (\r\n          date.isBefore(moment().set({ year: date.year(), month: 3, day: 1 }))\r\n        ) {\r\n          year = date.year() - 1; //                       month:3 => 4月\r\n        } else {\r\n          year = date.year();\r\n        }\r\n        return year;\r\n      })\r\n    );\r\n    const yearsSet = computed(() =>\r\n      years.value.filter((x, i, self) => self.indexOf(x) === i).reverse()\r\n    );\r\n    // 重複しない年度の数字を取得\r\n\r\n    const getItems = (year) => {\r\n      return photos\r\n        .filter((item) =>\r\n          moment(item.date).isBetween(\r\n            moment(`${year}-04-01`),\r\n            moment(`${year + 1}-04-01`),\r\n            undefined,\r\n            \"[)\"\r\n          )\r\n        )\r\n        .reverse();\r\n    };\r\n\r\n    const displayDate = (dateStr) => moment(dateStr).format(\"YYYY/MM/DD\");\r\n    const thumbnailPath = (item) => {\r\n      if (item.thumbnail) {\r\n        return item.thumbnail;\r\n      } else {\r\n        return \"/static/img/album_thum_default.jpg\";\r\n      }\r\n    };\r\n\r\n    const photoStaff = computed(() => store.state.user.is_staff);\r\n\r\n    return {\r\n      photos,\r\n      years,\r\n      yearsSet,\r\n      photoStaff,\r\n      getItems,\r\n      displayDate,\r\n      thumbnailPath,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card-wrapper {\r\n  padding: 1rem 0.5rem;\r\n\r\n  .card-photo {\r\n    display: inline-block;\r\n    position: relative;\r\n    border-radius: 3px;\r\n    color: #fff;\r\n    transition: 0.4s;\r\n\r\n    &:hover {\r\n      text-decoration: none;\r\n      color: #000;\r\n      &::after {\r\n        background-color: rgba(255, 255, 255, 1);\r\n        box-shadow: inset 0 0 0px 5px rgba(0, 0, 0, 0.8);\r\n      }\r\n    }\r\n    &::after {\r\n      content: \"\";\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      border-radius: 3px;\r\n      background-color: rgba(0, 0, 0, 0.8);\r\n      box-shadow: inset 0 0 0px 5px rgba(255, 255, 255, 1);\r\n      opacity: 0.3;\r\n      transition: background-color 0.4s;\r\n      z-index: 1;\r\n    }\r\n\r\n    img {\r\n      position: relative;\r\n      border-radius: 3px;\r\n    }\r\n    .photo-title,\r\n    .photo-date {\r\n      position: absolute;\r\n      z-index: 2;\r\n      max-width: calc(100% - 10px - 1.5rem);\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n    .photo-title {\r\n      top: 0.75rem;\r\n      left: 0.75rem;\r\n    }\r\n    .photo-date {\r\n      bottom: 0.75rem;\r\n      right: 0.75rem;\r\n      font-size: 0.75rem;\r\n    }\r\n  }\r\n}\r\n</style>","import { render } from \"./index.vue?vue&type=template&id=4d2c5b87&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=4d2c5b87&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\mhash\\\\Documents\\\\UnpluggedMessage\\\\front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4d2c5b87\"]])\n\nexport default __exports__"],"names":["class","photos","photo","key","id","href","url","target","thumbnail","src","alt","title","displayDate","date","setup","store","axios","then","res","length","push","data","catch","error","console","response","commit","level","message","appname","years","map","item","moment","year","isBefore","set","month","day","yearsSet","value","filter","x","i","self","indexOf","reverse","getItems","isBetween","undefined","dateStr","format","thumbnailPath","photoStaff","state","user","is_staff","__exports__","render"],"sourceRoot":""}