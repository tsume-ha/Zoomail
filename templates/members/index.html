{% extends 'base.html' %}
{% load static %}

{% block title %}マイページ | Unplugged Message{% endblock %}
{% block extrastyle %}
	<link rel="stylesheet" type="text/css" href="{% static 'css/members/index.css' %}">
	<script src="{% static 'js/all_kidoku.js' %}"></script>
{% endblock %}


{% block body %}
<section id="username" class="col-12 border-bottom">
	<h3 class="d-inline-block">{{ user.get_full_name }}</h3>
	{% if user.nickname %}
	<h4 class="d-inline-block">({{ user.nickname }})</h4>
	{% endif %}
</section>
<section id="menu" class="float-md-left col-md-4 col-lg-3 list-group pt-3">
	<a href="{% url 'members:update' %}" class="list-group-item list-group-item-action list-group-item-info">登録情報確認・変更</a>
	<a href="{% url 'members:email_confirm' %}" class="list-group-item list-group-item-action list-group-item-info">メール受信テスト</a>
	<a href="{% url 'members:oauth' %}" class="list-group-item list-group-item-action list-group-item-info">LiveLog・Google認証</a>
	{% if register_allowed %}
	<a href="{% url 'members:register_form' %}" class="list-group-item list-group-item-action list-group-item-warning">ユーザー登録へ</a>
	{% endif %}
	{% if adminenter_allowed %}
	<a href="/admin/" class="list-group-item list-group-item-action list-group-item-danger">管理者管理ページへ</a>
	{% endif %}
	<a href="{% url 'logout' %}" class="list-group-item list-group-item-action list-group-item-outline-secondary">ログアウト</a>
</section>
<section id="midoku" class="mypage_message float-md-right col-md-8 col-lg-9 py-3">
	<h5 class="d-inline-block">未読メッセージ</h5>
	{% if midoku %}
	<button type="submit" onclick="kidoku()" class="btn btn-outline-secondary btn-sm d-inline-block mb-1 ml-2">すべて既読にする</button>
	<form id="kidoku_form">
		{% csrf_token %}
		<input type="hidden" name="kidoku" value="true">
	</form>
	<ul class="list-unstyled">
		{% for message in midoku %}
		<li>
			<a href="{% url 'board:content' message.id %}">{{ message.title }}</a>
			<span class="small">{{ message.created_at|date:"Y/m/d D H:i" }} 送信</span>
		</li>
		{% endfor %}
	</ul>
	{% else %}
	<p class="alert alert-secondary m-0 p-2">すべてのメッセージをすでに読んています。</p>
	
	{% endif %}
</section>
<section id="yousend" class="mypage_message float-md-right col-md-8 col-lg-9 py-3 border-top">
	<h5>あなたが送信したメッセージ</h5>
	{% if yousend %}
	<ul class="list-unstyled">
		{% for message in yousend %}
		<li>
			<a href="{% url 'board:content' message.id %}">{{ message.title }}</a>
			<span class="small">{{ message.created_at|date:"Y/m/d D H:i" }} 送信</span>
		</li>
		{% endfor %}
	</ul>
	<p class="small alert alert-secondary m-0 p-2">これらのメッセージは送信後にあなたが編集することができます。</p>
	{% else %}
	メッセージ：0件
	{% endif %}
</section>
<section id="yourmessage_otherssend" class="mypage_message float-md-right col-md-8 col-lg-9 py-3 border-top">
	<h5>あなたの代わりに送信されたメッセージ</h5>
	{% if yourmessage_otherssend %}
	<ul class="list-unstyled">
		{% for message in yourmessage_otherssend %}
		<li>
			<a href="{% url 'board:content' message.id %}">{{ message.title }}</a>
			<span class="small">{{ message.created_at|date:"Y/m/d D H:i" }} 送信</span>
		</li>
		{% endfor %}
	</ul>
	<p class="small alert alert-secondary m-0 p-2">これらのメッセージは送信後にあなたが編集することができます。</p>
	{% else %}
	メッセージ：0件
	{% endif %}
</section>
{% endblock %}